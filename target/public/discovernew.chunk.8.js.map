{"version":3,"file":"discovernew.chunk.8.js","sources":["/plugin:discovernew/plugins/kibanaDiscover1/public/application/apps/main/utils/get_sharing_data.ts"],"sourcesContent":["/*\n * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n * or more contributor license agreements. Licensed under the Elastic License\n * 2.0 and the Server Side Public License, v 1; you may not use this file except\n * in compliance with, at your election, the Elastic License 2.0 or the Server\n * Side Public License, v 1.\n */\nimport { DOC_HIDE_TIME_COLUMN_SETTING, SORT_DEFAULT_ORDER_SETTING } from '../../../../../common';\nimport { getSortForSearchSource } from '../../../angular/doc_table';\n/**\n * Preparing data to share the current state as link or CSV/Report\n */\n\nexport async function getSharingData(currentSearchSource, state, config) {\n  const searchSource = currentSearchSource.createCopy();\n  const index = searchSource.getField('index');\n  searchSource.setField('sort', getSortForSearchSource(state.sort, index, config.get(SORT_DEFAULT_ORDER_SETTING)));\n  searchSource.removeField('highlight');\n  searchSource.removeField('highlightAll');\n  searchSource.removeField('aggs');\n  searchSource.removeField('size'); // Columns that the user has selected in the saved search\n\n  let columns = state.columns || [];\n\n  if (columns && columns.length > 0) {\n    // conditionally add the time field column:\n    let timeFieldName;\n    const hideTimeColumn = config.get(DOC_HIDE_TIME_COLUMN_SETTING);\n\n    if (!hideTimeColumn && index && index.timeFieldName) {\n      timeFieldName = index.timeFieldName;\n    }\n\n    if (timeFieldName && !columns.includes(timeFieldName)) {\n      columns = [timeFieldName, ...columns];\n    }\n  }\n\n  return {\n    searchSource: searchSource.getSerializedFields(true),\n    columns\n  };\n}\nexport const showPublicUrlSwitch = anonymousUserCapabilities => {\n  if (!anonymousUserCapabilities.discover) return false;\n  const discover = anonymousUserCapabilities.discover;\n  return !!discover.show;\n};"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}